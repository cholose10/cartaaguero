<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Carta</title>
  <style>
    body { font-family: Arial, sans-serif; margin:20px; background:#f7f3f0; color:#333;}
    form { background:#fff; padding:15px; border-radius:10px; margin-bottom:20px;}
    input,textarea { width:100%; padding:8px; margin:6px 0; border:1px solid #ccc; border-radius:6px;}
    table { width:100%; border-collapse:collapse; background:#fff;}
    th,td { border:1px solid #ddd; padding:8px; text-align:left;}
    th { background:#eee;}
    img { max-width:60px; }
  </style>
</head>
<body>
  <h1>Admin Carta</h1>
  <form id="form">
    <input type="hidden" id="editIndex">
    <label>Nombre</label>
    <input type="text" id="nombre" required>
    <label>Descripción</label>
    <textarea id="descripcion" required></textarea>
    <label>Precio</label>
    <input type="text" id="precio" required>
    <label>Imagen (ej: img/foto.jpg)</label>
    <input type="text" id="imagen" required>
    <label>Categoría</label>
    <input type="text" id="categoria" required>
    <button type="submit">Guardar</button>
  </form>

  <h2>Productos</h2>
  <table>
    <thead><tr><th>Imagen</th><th>Nombre</th><th>Descripción</th><th>Categoría</th><th>Precio</th><th>Acciones</th></tr></thead>
    <tbody id="tbody"></tbody>
  </table>

  <script>
    let productos=[];
    fetch('productos.json').then(r=>r.json()).then(d=>{productos=d; render();});

    function render(){
      const tb=document.getElementById('tbody'); tb.innerHTML='';
      productos.forEach((p,i)=>{
        tb.innerHTML+=`
        <tr>
          <td><img src="${p.imagen}" alt=""></td>
          <td>${p.nombre}</td>
          <td>${p.descripcion}</td>
          <td>${p.categoria}</td>
          <td>${p.precio}</td>
          <td><button onclick="edit(${i})">Editar</button><button onclick="del(${i})">Eliminar</button></td>
        </tr>`;
      });
    }

    document.getElementById('form').onsubmit=function(e){
      e.preventDefault();
      const idx=document.getElementById('editIndex').value;
      const prod={
        nombre:document.getElementById('nombre').value,
        descripcion:document.getElementById('descripcion').value,
        precio:document.getElementById('precio').value,
        imagen:document.getElementById('imagen').value,
        categoria:document.getElementById('categoria').value
      };
      if(idx===''){ productos.push(prod);} else { productos[idx]=prod; document.getElementById('editIndex').value='';}
      render();
      this.reset();
    }

    function edit(i){
      const p=productos[i];
      document.getElementById('nombre').value=p.nombre;
      document.getElementById('descripcion').value=p.descripcion;
      document.getElementById('precio').value=p.precio;
      document.getElementById('imagen').value=p.imagen;
      document.getElementById('categoria').value=p.categoria;
      document.getElementById('editIndex').value=i;
    }
    function del(i){ if(confirm('¿Eliminar producto?')){ productos.splice(i,1); render(); } }
  </script>
</body>
</html>
